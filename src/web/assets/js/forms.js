var FormBuilderSection=void 0;window.FormBuilderSection=Garnish.Base.extend({$container:null,$titlebar:null,$fieldsContainer:null,$optionsContainer:null,$previewContainer:null,$collapserBtn:null,$sectionToggleInput:null,$menuBtn:null,$status:null,modal:null,collapsed:!1,optionCollapsed:!0,type:null,$delete:null,init:function(t,e){this.type=e,this.$container=$(t),this.$menuBtn=this.$container.find(".actions > .settings"),this.$collapserBtn=this.$container.find(".actions > .bodytoggle"),this.$sectionToggleInput=this.$container.find(".section-toggle"),this.$titlebar=this.$container.find(".titlebar"),this.$fieldsContainer=this.$container.find(".body"),this.$optionsContainer=this.$container.find(".body-options"),this.$previewContainer=this.$container.find(".preview"),this.$status=this.$container.find(".actions > .status"),this.$delete=this.$container.find(".delete-btn"),Garnish.hasAttr(this.$container,"data-collapsed")&&this.collapse(),this._handleTitleBarClick=function(t){return t.preventDefault(),this.toggle()},this.addListener(this.$delete,"click",this.delete),this.addListener(this.$collapserBtn,"click",this.toggle),this.addListener(this.$titlebar,"doubletap",this._handleTitleBarClick)},toggle:function(){return this.collapsed?this.expand():(this.$sectionToggleInput.prop("checked",!0),this.collapse(!0))},collapse:function(t){var e=void 0;if(this.$sectionToggleInput.prop("checked",!0),!this.collapsed)return this.$container.addClass("bodycollapsed"),e="",this.$titlebar.find(".tout-title").text(),this.$previewContainer.html(e),this.$fieldsContainer.velocity("stop"),this.$container.velocity("stop"),t?(this.$fieldsContainer.velocity("fadeOut",{duration:"fast"}),this.$container.velocity({height:"100%"},"fast")):(this.$previewContainer.show(),this.$fieldsContainer.hide(),this.$container.css({height:"100%"})),this.collapsed=!0},expand:function(){var t=void 0,e=void 0;if(this.$sectionToggleInput.prop("checked",!1),this.collapsed)return this.$container.removeClass("bodycollapsed"),this.$fieldsContainer.velocity("stop"),this.$container.velocity("stop"),t=this.$container.height(),this.$container.height("auto"),this.$fieldsContainer.show(),e=this.$container.height(),this.$container.height(t),this.$fieldsContainer.hide().velocity("fadeIn",{duration:"fast"}),this.$container.velocity({height:e},"fast",$.proxy(function(){return this.$container.height("auto")},this)),this.collapsed=!1},disable:function(){return this.$fieldsContainer.find(".enable-integration-section").prop("checked",!1),this.$status.removeClass("on"),this.$status.addClass("off"),this.collapse(!0)},enable:function(){this.$fieldsContainer.find(".enable-integration-section").prop("checked",!0),this.$status.removeClass("off"),this.$status.addClass("on")},delete:function(){return this.$container.remove()},settings:function(){return this.modal?this.modal.show():this.modal=new SettingsModal(this)},updateSectionSettings:function(){return $.each(this.modal.$modalInputs,$.proxy(function(t,e){if(""!==$(e).val())return this.$container.prepend($(e).addClass("hidden"))},this))},onMenuOptionSelect:function(t){var e=void 0;switch(e=$(t),e.data("action")){case"collapse":return this.collapse(!0);case"expand":return this.expand();case"disable":return this.disable();case"enable":return this.enable(),this.expand();case"delete":return this.delete();case"settings":return this.settings()}}}),Garnish.$doc.ready(function(){$(".section-collapsible").each(function(t,e){new window.FormBuilderSection(e,$(e).data("type"))}),Craft.elementIndex&&Craft.elementIndex.on("selectSource",function(t){var e=void 0;e=t.target.$source.data("id"),e?$("#new-form-btn").attr("href",Craft.getCpUrl()+"/form-builder/forms/new?groupId="+e):$("#new-form-btn").attr("href",Craft.getCpUrl()+"/form-builder/forms/new?groupId=1")}),$(".fb-forms").length>0&&(new Clipboard(".copy-handle",{target:function(t){var e;e=$(t).data("handle"),Craft.cp.displayNotice(Craft.t("form-builder","Form handle `"+e+"` copied"))}}),new Clipboard(".twig-snippet",{text:function(t){var e,i;return e=$(t).data("handle"),i='{{ craft.fb.form("'+e+'") }}',Craft.cp.displayNotice(i+Craft.t("form-builder"," copied")),i}})),$(".delete-form").on("click",function(t){var e=void 0;t.preventDefault(),e={id:$(this).data("id")},confirm(Craft.t("form-builder","Are you sure you want to delete this form and all its entries?"))&&Craft.postActionRequest("form-builder/forms/delete",e,$.proxy(function(t,e){"success"===e&&(Craft.cp.displayNotice(Craft.t("form-builder","Form deleted")),window.location.href=Craft.getCpUrl()+"/form-builder/forms")},this))})});